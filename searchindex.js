Search.setIndex({"docnames": ["index", "introduction", "modules", "torchnf", "torchnf.conditioners", "torchnf.core", "torchnf.exceptions", "torchnf.lit_models", "torchnf.metrics", "torchnf.models", "torchnf.networks", "torchnf.prior", "torchnf.transformers", "torchnf.utils"], "filenames": ["index.rst", "introduction.rst", "modules.rst", "torchnf.rst", "torchnf.conditioners.rst", "torchnf.core.rst", "torchnf.exceptions.rst", "torchnf.lit_models.rst", "torchnf.metrics.rst", "torchnf.models.rst", "torchnf.networks.rst", "torchnf.prior.rst", "torchnf.transformers.rst", "torchnf.utils.rst"], "titles": ["Welcome to torchnf\u2019s documentation!", "Introduction", "torchnf", "torchnf", "torchnf.conditioners", "torchnf.core", "torchnf.exceptions", "torchnf.lit_models", "torchnf.metrics", "torchnf.models", "torchnf.networks", "torchnf.prior", "torchnf.transformers", "torchnf.utils"], "terms": {"introduct": 0, "condition": [0, 2, 3, 5, 10], "core": [0, 2, 3], "except": [0, 2, 3, 10], "lit_model": [0, 2, 3, 9], "metric": [0, 2, 3, 7, 9], "model": [0, 2, 3, 4, 7, 8], "network": [0, 2, 3], "prior": [0, 2, 3, 7, 9], "transform": [0, 2, 3, 4, 5], "util": [0, 2, 3], "index": 0, "modul": [0, 4, 5, 7, 9, 10, 12], "search": 0, "page": 0, "good": 1, "morn": 1, "The": [4, 5, 8, 9, 11, 12, 13], "forward": [4, 5, 7, 9, 10, 11, 12], "method": [4, 5, 9, 10, 12], "should": [4, 9, 11, 12], "return": [4, 5, 8, 9, 10, 11, 12, 13], "set": 4, "paramet": [4, 5, 8, 9, 10, 11, 12, 13], "upon": [4, 12], "which": [4, 5, 9, 10, 12], "condit": [4, 5, 9, 12], "class": [4, 5, 7, 8, 9, 10, 11, 12], "autoregressivecondition": 4, "base": [4, 5, 6, 7, 8, 9, 10, 11, 12], "todo": [4, 10, 11], "result": [4, 9, 12, 13], "triangular": 4, "determin": [4, 5, 12], "train": [4, 5, 9], "bool": [4, 5, 9, 10], "alia": [4, 11, 12], "torch": [4, 5, 7, 9, 10, 11, 12, 13], "nn": [4, 5, 7, 10], "inherit": [4, 12], "all": [4, 5, 12, 13], "maskedcondition": 4, "mask": 4, "option": [4, 9], "booltensor": [4, 12], "none": [4, 5, 9, 12], "net": 4, "sequenti": [4, 5, 10], "In": [4, 8, 12], "thi": [4, 5, 8, 9, 10, 11, 12, 13], "input": [4, 5, 12, 13], "x": [4, 5, 9, 12, 13], "ar": [4, 8, 9, 12], "first": [4, 13], "so": 4, "onli": 4, "subset": 4, "can": [4, 8, 9, 11], "influenc": 4, "furthermor": 4, "lambda": [4, 12], "us": [4, 8, 10, 12], "logic": 4, "negat": 4, "origin": 4, "when": [4, 11], "point": [4, 11], "wise": 4, "jacobian": [4, 5, 12], "A": [4, 8, 9, 12], "normal": [4, 5, 8, 9], "flow": [4, 5, 7, 8, 9, 10], "layer": [4, 5, 10, 12], "where": [4, 8, 9, 12], "call": [4, 9, 12], "coupl": 4, "archetyp": 4, "exampl": [4, 9], "real": 4, "nvp": 4, "arvix": [4, 8, 9], "1605": 4, "08803": 4, "deriv": [4, 8, 11, 12], "mai": 4, "overrid": [4, 11, 12], "_forward": [4, 12], "get_mask": 4, "explain": 4, "how": 4, "get": [4, 9], "depend": 4, "data": [4, 8, 11, 12], "shape": [4, 12, 13], "consid": 4, "allow": [4, 10], "function": [4, 8, 12], "valu": 4, "aren": 4, "t": [4, 8, 12], "zero": 4, "e": [4, 8, 10, 12], "g": [4, 8, 10], "nois": 4, "drawn": [4, 9], "from": [4, 5, 7, 8, 9], "known": 4, "distribut": [4, 9, 11], "tensor": [4, 5, 7, 8, 9, 11, 12, 13], "context": [4, 5, 12], "dict": [4, 5, 8, 9, 10, 12], "after": [4, 11], "element": [4, 8, 12, 13], "nan": 4, "s": [4, 5, 12, 13], "effect": [4, 8, 13], "doe": [4, 5, 9, 11, 12, 13], "follow": [4, 5, 9, 12, 13], "self": [4, 5, 9, 11, 12], "mul": 4, "param": [4, 5, 12], "denot": 4, "add": 4, "full_lik": 4, "float": [4, 8, 12], "multipli": 4, "simplecondition": 4, "init_param": 4, "union": [4, 9], "list": [4, 10, 11, 12], "independ": [4, 10, 11], "regist": 4, "make": [4, 11], "them": 4, "learnabl": 4, "simpli": [4, 5, 8, 9, 11], "initi": 4, "expand": [4, 13], "correct": 4, "flowlay": 5, "repres": [5, 9, 10], "subclass": 5, "compos": 5, "sever": 5, "aggreg": 5, "log": [5, 8, 9, 11, 12], "tupl": [5, 7, 9, 11, 12], "pass": [5, 9, 12], "invers": [5, 9, 12], "y": [5, 8, 9, 12, 13], "step_forward": 5, "wip": 5, "specif": [5, 9, 10], "modular": 5, "structur": 5, "provid": [5, 9], "flexibl": 5, "construct": 5, "varieti": 5, "differ": 5, "an": [5, 8, 9, 10, 12], "instanc": [5, 10], "implement": [5, 7, 9, 10], "given": [5, 8, 11], "whose": 5, "take": [5, 9, 12], "conditioner_forward": 5, "xy": 5, "unless": [5, 9, 12], "overriden": 5, "overridden": [5, 9, 12], "ldj": 5, "transformer_forward": 5, "freez": 5, "detach": 5, "autograd": 5, "graph": 5, "transformer_invers": 5, "transfom": 5, "unfreez": 5, "reattach": 5, "inputoutsidedomainerror": 6, "altern": 7, "pytorch_lightn": [7, 9], "lightningmodul": [7, 9], "rather": 7, "than": [7, 12], "standard": [7, 9], "litboltzmanngener": 7, "target": [7, 8, 9], "callabl": [7, 9], "object": [7, 8, 10, 11, 12], "test": 7, "configure_optim": [7, 9], "batch": [7, 11], "sampl": [7, 8, 9, 11], "train_dataload": 7, "training_step": [7, 9], "batch_idx": 7, "training_step_end": 7, "output": [7, 8, 9, 12], "val_dataload": 7, "validation_epoch_end": 7, "validation_step": [7, 9], "logweightmetr": 8, "log_weight": [8, 9], "lightweight": 8, "comput": [8, 11], "weight": [8, 9], "refer": [8, 9, 12], "logarithm": [8, 12], "statist": [8, 9], "gener": [8, 9, 10], "defin": [8, 10], "w": 8, "p": 8, "q": 8, "probabl": [8, 11], "densiti": [8, 9, 11], "respect": [8, 12], "One": [8, 13], "dimension": [8, 13], "abov": 8, "properti": [8, 9, 11, 12], "accept": 8, "fraction": 8, "propos": 8, "dure": 8, "metropoli": 8, "hast": 8, "sim": 8, "tild": 8, "prime": 8, "min": 8, "left": [8, 12], "1": [8, 9, 11, 12, 13], "frac": [8, 12], "right": [8, 12], "speak": 8, "rate": [8, 9], "larger": 8, "overlap": 8, "between": [8, 9], "asdict": 8, "str": [8, 9, 10, 13], "dictionari": 8, "effective_sample_s": 8, "size": [8, 11, 12, 13], "normalis": [8, 12], "n_": 8, "eff": 8, "n": 8, "sum_": 8, "2": [8, 12], "2101": 8, "08176": 8, "integrated_autocorrel": 8, "integr": 8, "autocorrel": 8, "reject": 8, "histori": 8, "limit": 8, "infti": 8, "re": 8, "interpret": 8, "fail": 8, "transit": 8, "over": [8, 12, 13], "number": [8, 9, 11, 12], "markov": 8, "chain": 8, "step": [8, 9], "gamma": 8, "0": [8, 9, 12, 13], "pr": 8, "text": 8, "consecut": 8, "estim": 8, "obtain": 8, "sum": [8, 13], "occurr": 8, "largest": 8, "possibl": 8, "total": [8, 9], "1904": 8, "12072": 8, "kl_diverg": 8, "kullbach": 8, "leibler": 8, "diverg": 8, "d_": 8, "kl": [8, 9], "longest_rejection_run": 8, "int": [8, 9, 10, 11, 12, 13], "phase": 8, "contain": [9, 10, 12], "some": [9, 10], "see": [9, 10], "equival": 9, "version": [9, 10], "boltzmanngener": 9, "boltzmann": 9, "term": 9, "wa": 9, "introduc": [9, 12], "1812": 9, "01729": 9, "evalu": 9, "what": 9, "log_prob_prior": 9, "log_det_jacob": [9, 12], "log_prob_target": 9, "through": 9, "under": 9, "rais": 9, "notimplementederror": 9, "gradient": 9, "disabl": 9, "perform": [9, 12], "singl": 9, "loss": 9, "training_step_fwd_kl": 9, "training_step_rev_kl": 9, "revers": 9, "_": 9, "mean": 9, "neg": 9, "valid": 9, "output_dir": 9, "pathlik": 9, "essenti": 9, "act": 9, "save": 9, "load": 9, "etc": 9, "It": 9, "assign": 9, "directori": 9, "checkpoint": 9, "state": 9, "dedic": 9, "If": 9, "resort": 9, "default": 9, "class_nam": 9, "timestamp": [9, 13], "current": [9, 13], "work": [9, 10], "optim": 9, "learn": 9, "schedul": 9, "overidden": 9, "user": [9, 10], "adam": 9, "lr": 9, "001": 9, "lr_schedul": 9, "cosineannealinglr": 9, "t_max": 9, "10000": 9, "fit": 9, "n_step": 9, "val_interv": 9, "ckpt_interv": 9, "run": [9, 12], "loop": 9, "rang": 9, "global_step": 9, "zero_grad": 9, "backward": 9, "note": 9, "global": 9, "within": 9, "sinc": 9, "initialis": 9, "load_checkpoint": 9, "pt": 9, "file": 9, "save_checkpoint": 9, "path": 9, "name": 9, "ckpt_": 9, "snapshot": 9, "well": 9, "must": 9, "just": 9, "onc": 9, "ani": 9, "conveni": 10, "neural": 10, "herein": 10, "__call__": [10, 11, 12], "one": [10, 12, 13], "easili": 10, "multipl": 10, "each": [10, 13], "same": [10, 12], "spec": 10, "document": 10, "wai": 10, "creat": 10, "new": [10, 11], "ident": [10, 11, 12], "specifi": 10, "chang": [10, 12], "dataclass": 10, "replac": 10, "convnet": 10, "dim": [10, 13], "in_channel": 10, "out_channel": 10, "hidden_shap": 10, "activ": 10, "kernel_s": 10, "activation_kwarg": 10, "factori": 10, "skip_final_activ": 10, "fals": 10, "conv_kwarg": 10, "convolut": 10, "conv2d": 10, "1d": 10, "3d": 10, "convnetcircular": 10, "circular": 10, "pad": 10, "densenet": 10, "in_featur": 10, "out_featur": 10, "linear_kwarg": 10, "fulli": 10, "connect": 10, "feed": 10, "linear": 10, "simplenetbuild": 10, "net_spec": 10, "purpos": 10, "builder": 10, "progress": 10, "batch_siz": [11, 12], "draw": 11, "modifi": 11, "instanti": 11, "log_prob": 11, "discuss": 11, "requir": 11, "__next__": 11, "its": 11, "simpleprior": 11, "expand_shap": 11, "wrap": 11, "around": [11, 12], "iter": 11, "parametris": 12, "biject": 12, "more": 12, "along": [12, 13], "thei": 12, "math": 12, "do": 12, "longrightarrow": 12, "f": 12, "lvert": 12, "partial": 12, "rvert": 12, "thank": 12, "theorem": 12, "relat": 12, "affinetransform": 12, "pointwis": 12, "affin": 12, "mapsto": 12, "odot": 12, "sum_i": 12, "s_i": 12, "i": 12, "degre": 12, "freedom": 12, "being": 12, "argument": 12, "stack": [12, 13], "order": 12, "dimens": [12, 13], "split": [12, 13], "parma": 12, "data_shap": [12, 13], "n_param": 12, "_invers": 12, "codomain": 12, "classvar": 12, "inf": 12, "domain": 12, "identity_param": 12, "per": 12, "rqsplinetransform": 12, "n_segment": 12, "interv": 12, "ration": 12, "quadrat": 12, "spline": 12, "build_splin": 12, "width": 12, "height": 12, "build": 12, "gregori": 12, "delbourgo": 12, "1983": 12, "un": 12, "segment": 12, "unconstrain": 12, "knot": 12, "3": 12, "constrain": 12, "4": 12, "coordin": 12, "5": 12, "j": 12, "r": 12, "c2": 12, "interpol": 12, "monoton": 12, "ima": 12, "journal": 12, "numer": 12, "analysi": 12, "141": 12, "152": 12, "handle_inputs_outside_interv": 12, "outside_interval_mask": 12, "handl": 12, "fall": 12, "outsid": 12, "submit": 12, "debug": 12, "event": 12, "1000": 12, "true": 12, "correspond": 12, "fell": 12, "rqsplinetransformcircular": 12, "params_dim": 12, "rqsplinetransformclosedinterv": 12, "rescal": 12, "wrapper": 12, "_nan_to_ident": 12, "translat": 12, "There": 12, "volum": 12, "expand_el": 13, "stack_dim": 13, "chunk": 13, "zeroth": 13, "el": 13, "out": 13, "sum_except_batch": 13, "fmt": 13, "m": 13, "dt": 13, "h": 13, "string": 13, "represent": 13, "datetim": 13}, "objects": {"": [[3, 0, 0, "-", "torchnf"]], "torchnf": [[4, 0, 0, "-", "conditioners"], [5, 0, 0, "-", "core"], [6, 0, 0, "-", "exceptions"], [7, 0, 0, "-", "lit_models"], [8, 0, 0, "-", "metrics"], [9, 0, 0, "-", "models"], [10, 0, 0, "-", "networks"], [11, 0, 0, "-", "prior"], [12, 0, 0, "-", "transformers"], [13, 0, 0, "-", "utils"]], "torchnf.conditioners": [[4, 1, 1, "", "AutoregressiveConditioner"], [4, 1, 1, "", "Conditioner"], [4, 1, 1, "", "MaskedConditioner"], [4, 1, 1, "", "SimpleConditioner"]], "torchnf.conditioners.AutoregressiveConditioner": [[4, 2, 1, "", "training"]], "torchnf.conditioners.Conditioner": [[4, 2, 1, "", "training"]], "torchnf.conditioners.MaskedConditioner": [[4, 3, 1, "", "forward"], [4, 3, 1, "", "get_mask"], [4, 2, 1, "", "training"]], "torchnf.conditioners.SimpleConditioner": [[4, 3, 1, "", "forward"], [4, 2, 1, "", "training"]], "torchnf.core": [[5, 1, 1, "", "Flow"], [5, 1, 1, "", "FlowLayer"]], "torchnf.core.Flow": [[5, 3, 1, "", "forward"], [5, 3, 1, "", "inverse"], [5, 3, 1, "", "step_forward"]], "torchnf.core.FlowLayer": [[5, 3, 1, "", "conditioner_forward"], [5, 3, 1, "", "forward"], [5, 3, 1, "", "freeze"], [5, 3, 1, "", "inverse"], [5, 2, 1, "", "training"], [5, 3, 1, "", "transformer_forward"], [5, 3, 1, "", "transformer_inverse"], [5, 3, 1, "", "unfreeze"]], "torchnf.exceptions": [[6, 4, 1, "", "InputOutsideDomainError"]], "torchnf.lit_models": [[7, 1, 1, "", "LitBoltzmannGenerator"]], "torchnf.lit_models.LitBoltzmannGenerator": [[7, 3, 1, "", "configure_optimizers"], [7, 3, 1, "", "forward"], [7, 3, 1, "", "sample"], [7, 3, 1, "", "train_dataloader"], [7, 3, 1, "", "training_step"], [7, 3, 1, "", "training_step_end"], [7, 3, 1, "", "val_dataloader"], [7, 3, 1, "", "validation_epoch_end"], [7, 3, 1, "", "validation_step"]], "torchnf.metrics": [[8, 1, 1, "", "LogWeightMetrics"]], "torchnf.metrics.LogWeightMetrics": [[8, 5, 1, "", "acceptance"], [8, 3, 1, "", "asdict"], [8, 5, 1, "", "effective_sample_size"], [8, 5, 1, "", "integrated_autocorrelation"], [8, 5, 1, "", "kl_divergence"], [8, 5, 1, "", "longest_rejection_run"]], "torchnf.models": [[9, 1, 1, "", "BoltzmannGenerator"], [9, 1, 1, "", "Model"]], "torchnf.models.BoltzmannGenerator": [[9, 3, 1, "", "forward"], [9, 3, 1, "", "inverse"], [9, 3, 1, "", "sample"], [9, 2, 1, "", "training"], [9, 3, 1, "", "training_step"], [9, 3, 1, "", "training_step_fwd_kl"], [9, 3, 1, "", "training_step_rev_kl"], [9, 3, 1, "", "validation_step"]], "torchnf.models.Model": [[9, 3, 1, "", "configure_optimizers"], [9, 3, 1, "", "fit"], [9, 5, 1, "", "global_step"], [9, 3, 1, "", "load_checkpoint"], [9, 5, 1, "", "output_dir"], [9, 3, 1, "", "save_checkpoint"], [9, 2, 1, "", "training"], [9, 3, 1, "", "training_step"], [9, 3, 1, "", "validate"], [9, 3, 1, "", "validation_step"]], "torchnf.networks": [[10, 1, 1, "", "ConvNet"], [10, 1, 1, "", "ConvNetCircular"], [10, 1, 1, "", "DenseNet"], [10, 1, 1, "", "SimpleNetBuilder"]], "torchnf.networks.ConvNet": [[10, 2, 1, "", "activation"], [10, 2, 1, "", "activation_kwargs"], [10, 2, 1, "", "conv_kwargs"], [10, 2, 1, "", "dim"], [10, 2, 1, "", "hidden_shape"], [10, 2, 1, "", "in_channels"], [10, 2, 1, "", "kernel_size"], [10, 2, 1, "", "out_channels"], [10, 2, 1, "", "skip_final_activation"]], "torchnf.networks.ConvNetCircular": [[10, 2, 1, "", "activation"], [10, 2, 1, "", "activation_kwargs"], [10, 2, 1, "", "conv_kwargs"], [10, 2, 1, "", "dim"], [10, 2, 1, "", "hidden_shape"], [10, 2, 1, "", "in_channels"], [10, 2, 1, "", "kernel_size"], [10, 2, 1, "", "out_channels"]], "torchnf.networks.DenseNet": [[10, 2, 1, "", "activation"], [10, 2, 1, "", "activation_kwargs"], [10, 2, 1, "", "hidden_shape"], [10, 2, 1, "", "in_features"], [10, 2, 1, "", "linear_kwargs"], [10, 2, 1, "", "out_features"], [10, 2, 1, "", "skip_final_activation"]], "torchnf.prior": [[11, 1, 1, "", "Prior"], [11, 1, 1, "", "SimplePrior"]], "torchnf.prior.Prior": [[11, 3, 1, "", "__call__"], [11, 3, 1, "", "__next__"], [11, 5, 1, "", "batch_size"], [11, 3, 1, "", "forward"], [11, 3, 1, "", "log_prob"], [11, 3, 1, "", "sample"]], "torchnf.prior.SimplePrior": [[11, 3, 1, "", "log_prob"], [11, 3, 1, "", "sample"]], "torchnf.transformers": [[12, 1, 1, "", "AffineTransform"], [12, 1, 1, "", "RQSplineTransform"], [12, 1, 1, "", "RQSplineTransformCircular"], [12, 1, 1, "", "RQSplineTransformClosedInterval"], [12, 1, 1, "", "Rescaling"], [12, 1, 1, "", "Transformer"], [12, 1, 1, "", "Translation"]], "torchnf.transformers.AffineTransform": [[12, 3, 1, "", "_forward"], [12, 3, 1, "", "_inverse"], [12, 2, 1, "", "codomain"], [12, 2, 1, "", "domain"], [12, 5, 1, "", "identity_params"], [12, 5, 1, "", "n_params"]], "torchnf.transformers.RQSplineTransform": [[12, 3, 1, "", "_forward"], [12, 3, 1, "", "_inverse"], [12, 3, 1, "", "build_spline"], [12, 2, 1, "", "codomain"], [12, 2, 1, "", "domain"], [12, 3, 1, "", "handle_inputs_outside_interval"], [12, 5, 1, "", "identity_params"], [12, 5, 1, "", "n_params"]], "torchnf.transformers.Rescaling": [[12, 3, 1, "", "_forward"], [12, 3, 1, "", "_inverse"], [12, 2, 1, "", "codomain"], [12, 2, 1, "", "domain"], [12, 5, 1, "", "identity_params"], [12, 5, 1, "", "n_params"]], "torchnf.transformers.Transformer": [[12, 3, 1, "", "__call__"], [12, 3, 1, "", "_forward"], [12, 3, 1, "", "_inverse"], [12, 2, 1, "", "codomain"], [12, 2, 1, "", "domain"], [12, 3, 1, "", "forward"], [12, 5, 1, "", "identity_params"], [12, 3, 1, "", "inverse"], [12, 5, 1, "", "n_params"]], "torchnf.transformers.Translation": [[12, 3, 1, "", "_forward"], [12, 2, 1, "", "codomain"], [12, 2, 1, "", "domain"], [12, 5, 1, "", "identity_params"], [12, 5, 1, "", "n_params"]], "torchnf.utils": [[13, 6, 1, "", "expand_elements"], [13, 6, 1, "", "sum_except_batch"], [13, 6, 1, "", "timestamp"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:exception", "5": "py:property", "6": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "exception", "Python exception"], "5": ["py", "property", "Python property"], "6": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "torchnf": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "s": 0, "document": 0, "content": 0, "indic": 0, "tabl": 0, "introduct": 1, "condition": 4, "core": 5, "except": 6, "lit_model": 7, "metric": 8, "model": 9, "network": 10, "prior": 11, "transform": 12, "util": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})