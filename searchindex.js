Search.setIndex({"docnames": ["index", "modules", "torchnf"], "filenames": ["index.rst", "modules.rst", "torchnf.rst"], "titles": ["Welcome to torchnf\u2019s documentation!", "torchnf", "torchnf package"], "terms": {"packag": [0, 1], "submodul": [0, 1], "condition": [0, 1], "modul": [0, 1], "core": [0, 1], "except": [0, 1], "lit_model": [0, 1], "metric": [0, 1], "model": [0, 1], "network": [0, 1], "prior": [0, 1], "transform": [0, 1], "util": [0, 1], "index": 0, "search": 0, "page": 0, "content": 1, "class": 2, "autoregressivecondition": 2, "base": 2, "triangular": 2, "jacobian": 2, "train": 2, "bool": 2, "maskedcondition": 2, "mask": 2, "option": 2, "booltensor": 2, "none": 2, "net": 2, "sequenti": 2, "coupl": 2, "layer": 2, "type": 2, "forward": 2, "x": 2, "tensor": 2, "context": 2, "dict": 2, "defin": 2, "comput": 2, "perform": 2, "everi": 2, "call": 2, "should": 2, "overridden": 2, "all": 2, "subclass": 2, "although": 2, "recip": 2, "pass": 2, "need": 2, "within": 2, "thi": 2, "function": 2, "one": 2, "instanc": 2, "afterward": 2, "instead": 2, "sinc": 2, "former": 2, "take": 2, "care": 2, "run": 2, "regist": 2, "hook": 2, "while": 2, "latter": 2, "silent": 2, "ignor": 2, "them": 2, "get_mask": 2, "simplecondition": 2, "init_param": 2, "union": 2, "list": 2, "float": 2, "diagon": 2, "input": 2, "flow": 2, "arg": 2, "ordereddict": 2, "str": 2, "tupl": 2, "torch": 2, "invers": 2, "y": 2, "step_forward": 2, "flowlay": 2, "_flowlay": 2, "conditioner_forward": 2, "xy": 2, "transformer_forward": 2, "param": 2, "transformer_invers": 2, "inputoutsidedomainerror": 2, "logweightmetr": 2, "log_weight": 2, "object": 2, "lightweight": 2, "us": 2, "log": 2, "weight": 2, "output": 2, "refer": 2, "logarithm": 2, "statist": 2, "gener": 2, "configur": 2, "psi": 2, "w": 2, "p": 2, "q": 2, "where": 2, "ar": 2, "target": 2, "probabl": 2, "densiti": 2, "respect": 2, "paramet": 2, "One": 2, "dimension": 2, "properti": 2, "accept": 2, "fraction": 2, "propos": 2, "dure": 2, "metropoli": 2, "hast": 2, "given": 2, "phi": 2, "candid": 2, "sim": 2, "tild": 2, "A": 2, "prime": 2, "min": 2, "left": 2, "1": 2, "frac": 2, "right": 2, "speak": 2, "rate": 2, "larger": 2, "overlap": 2, "between": 2, "asdict": 2, "effective_sample_s": 2, "effect": 2, "sampl": 2, "size": 2, "normalis": 2, "n_": 2, "eff": 2, "n": 2, "sum_": 2, "2": 2, "http": 2, "arxiv": 2, "org": 2, "ab": 2, "2101": 2, "08176": 2, "integrated_autocorrel": 2, "integr": 2, "autocorrel": 2, "deriv": 2, "from": 2, "reject": 2, "histori": 2, "In": 2, "limit": 2, "t": 2, "infti": 2, "can": 2, "re": 2, "interpret": 2, "fail": 2, "transit": 2, "over": 2, "number": 2, "markov": 2, "chain": 2, "step": 2, "gamma": 2, "0": 2, "pr": 2, "text": 2, "consecut": 2, "an": 2, "estim": 2, "obtain": 2, "simpli": 2, "sum": 2, "occurr": 2, "normal": 2, "largest": 2, "possibl": 2, "total": 2, "1904": 2, "12072": 2, "kl_diverg": 2, "kullbach": 2, "leibler": 2, "diverg": 2, "d_": 2, "kl": 2, "longest_rejection_run": 2, "int": 2, "phase": 2, "boltzmanngener": 2, "callabl": 2, "boltzmann": 2, "drawn": 2, "distribut": 2, "through": 2, "evalu": 2, "under": 2, "training_step": 2, "validation_step": 2, "output_dir": 2, "pathlik": 2, "configure_optim": 2, "fit": 2, "n_step": 2, "val_interv": 2, "ckpt_interv": 2, "global_step": 2, "load_checkpoint": 2, "path": 2, "save_checkpoint": 2, "valid": 2, "convnet": 2, "dim": 2, "in_channel": 2, "out_channel": 2, "hidden_shap": 2, "activ": 2, "kernel_s": 2, "activation_kwarg": 2, "factori": 2, "skip_final_activ": 2, "fals": 2, "conv_kwarg": 2, "convnetcircular": 2, "densenet": 2, "in_featur": 2, "out_featur": 2, "linear_kwarg": 2, "simplenetbuild": 2, "net_spec": 2, "batch_siz": 2, "log_prob": 2, "simpleprior": 2, "expand_shap": 2, "wrap": 2, "around": 2, "make": 2, "iter": 2, "contain": 2, "parametris": 2, "biject": 2, "more": 2, "return": 2, "along": 2, "determin": 2, "thei": 2, "log_det_jacob": 2, "param1": 2, "param2": 2, "math": 2, "do": 2, "lambda": 2, "longrightarrow": 2, "f": 2, "lvert": 2, "partial": 2, "rvert": 2, "note": 2, "det": 2, "affinetransform": 2, "pointwis": 2, "affin": 2, "mapsto": 2, "odot": 2, "e": 2, "s": 2, "log_scal": 2, "The": 2, "scale": 2, "factor": 2, "shift": 2, "translat": 2, "codomain": 2, "classvar": 2, "inf": 2, "domain": 2, "identity_param": 2, "n_param": 2, "rqsplinetransform": 2, "n_segment": 2, "interv": 2, "build_splin": 2, "width": 2, "height": 2, "build": 2, "ration": 2, "quadrat": 2, "spline": 2, "introduc": 2, "gregori": 2, "delbourgo": 2, "_": 2, "un": 2, "segment": 2, "unconstrain": 2, "knot": 2, "constrain": 2, "knots_xcoord": 2, "coordin": 2, "knots_ycoord": 2, "handle_inputs_outside_interv": 2, "outside_interval_mask": 2, "rqsplinetransformcircular": 2, "params_dim": 2, "rqsplinetransformclosedinterv": 2, "rescal": 2, "torchlft": 2, "inv_resc": 2, "expand_el": 2, "data_shap": 2, "stack_dim": 2, "sum_except_batch": 2, "timestamp": 2, "fmt": 2, "m": 2, "dt": 2, "h": 2}, "objects": {"": [[2, 0, 0, "-", "torchnf"]], "torchnf": [[2, 0, 0, "-", "conditioners"], [2, 0, 0, "-", "core"], [2, 0, 0, "-", "exceptions"], [2, 0, 0, "-", "metrics"], [2, 0, 0, "-", "models"], [2, 0, 0, "-", "networks"], [2, 0, 0, "-", "prior"], [2, 0, 0, "-", "transformers"], [2, 0, 0, "-", "utils"]], "torchnf.conditioners": [[2, 1, 1, "", "AutoregressiveConditioner"], [2, 1, 1, "", "Conditioner"], [2, 1, 1, "", "MaskedConditioner"], [2, 1, 1, "", "SimpleConditioner"]], "torchnf.conditioners.AutoregressiveConditioner": [[2, 2, 1, "", "training"]], "torchnf.conditioners.Conditioner": [[2, 2, 1, "", "training"]], "torchnf.conditioners.MaskedConditioner": [[2, 3, 1, "", "forward"], [2, 3, 1, "", "get_mask"], [2, 2, 1, "", "training"]], "torchnf.conditioners.SimpleConditioner": [[2, 3, 1, "", "forward"], [2, 2, 1, "", "training"]], "torchnf.core": [[2, 1, 1, "", "Flow"], [2, 1, 1, "", "FlowLayer"]], "torchnf.core.Flow": [[2, 3, 1, "", "forward"], [2, 3, 1, "", "inverse"], [2, 3, 1, "", "step_forward"]], "torchnf.core.FlowLayer": [[2, 3, 1, "", "conditioner_forward"], [2, 3, 1, "", "forward"], [2, 3, 1, "", "inverse"], [2, 2, 1, "", "training"], [2, 3, 1, "", "transformer_forward"], [2, 3, 1, "", "transformer_inverse"]], "torchnf.exceptions": [[2, 4, 1, "", "InputOutsideDomainError"]], "torchnf.metrics": [[2, 1, 1, "", "LogWeightMetrics"]], "torchnf.metrics.LogWeightMetrics": [[2, 5, 1, "", "acceptance"], [2, 3, 1, "", "asdict"], [2, 5, 1, "", "effective_sample_size"], [2, 5, 1, "", "integrated_autocorrelation"], [2, 5, 1, "", "kl_divergence"], [2, 5, 1, "", "longest_rejection_run"]], "torchnf.models": [[2, 1, 1, "", "BoltzmannGenerator"], [2, 1, 1, "", "Model"]], "torchnf.models.BoltzmannGenerator": [[2, 3, 1, "", "forward"], [2, 3, 1, "", "inverse"], [2, 3, 1, "", "sample"], [2, 2, 1, "", "training"], [2, 3, 1, "", "training_step"], [2, 3, 1, "", "validation_step"]], "torchnf.models.Model": [[2, 3, 1, "", "configure_optimizers"], [2, 3, 1, "", "fit"], [2, 5, 1, "", "global_step"], [2, 3, 1, "", "load_checkpoint"], [2, 5, 1, "", "output_dir"], [2, 3, 1, "", "save_checkpoint"], [2, 2, 1, "", "training"], [2, 3, 1, "", "training_step"], [2, 3, 1, "", "validate"], [2, 3, 1, "", "validation_step"]], "torchnf.networks": [[2, 1, 1, "", "ConvNet"], [2, 1, 1, "", "ConvNetCircular"], [2, 1, 1, "", "DenseNet"], [2, 1, 1, "", "SimpleNetBuilder"]], "torchnf.networks.ConvNet": [[2, 2, 1, "", "activation"], [2, 2, 1, "", "activation_kwargs"], [2, 2, 1, "", "conv_kwargs"], [2, 2, 1, "", "dim"], [2, 2, 1, "", "hidden_shape"], [2, 2, 1, "", "in_channels"], [2, 2, 1, "", "kernel_size"], [2, 2, 1, "", "out_channels"], [2, 2, 1, "", "skip_final_activation"]], "torchnf.networks.ConvNetCircular": [[2, 2, 1, "", "activation"], [2, 2, 1, "", "activation_kwargs"], [2, 2, 1, "", "conv_kwargs"], [2, 2, 1, "", "dim"], [2, 2, 1, "", "hidden_shape"], [2, 2, 1, "", "in_channels"], [2, 2, 1, "", "kernel_size"], [2, 2, 1, "", "out_channels"]], "torchnf.networks.DenseNet": [[2, 2, 1, "", "activation"], [2, 2, 1, "", "activation_kwargs"], [2, 2, 1, "", "hidden_shape"], [2, 2, 1, "", "in_features"], [2, 2, 1, "", "linear_kwargs"], [2, 2, 1, "", "out_features"], [2, 2, 1, "", "skip_final_activation"]], "torchnf.prior": [[2, 1, 1, "", "Prior"], [2, 1, 1, "", "SimplePrior"]], "torchnf.prior.Prior": [[2, 5, 1, "", "batch_size"], [2, 3, 1, "", "forward"], [2, 3, 1, "", "log_prob"], [2, 3, 1, "", "sample"]], "torchnf.prior.SimplePrior": [[2, 3, 1, "", "log_prob"], [2, 3, 1, "", "sample"]], "torchnf.transformers": [[2, 1, 1, "", "AffineTransform"], [2, 1, 1, "", "RQSplineTransform"], [2, 1, 1, "", "RQSplineTransformCircular"], [2, 1, 1, "", "RQSplineTransformClosedInterval"], [2, 1, 1, "", "Rescaling"], [2, 1, 1, "", "Transformer"], [2, 1, 1, "", "Translation"]], "torchnf.transformers.AffineTransform": [[2, 2, 1, "", "codomain"], [2, 2, 1, "", "domain"], [2, 5, 1, "", "identity_params"], [2, 5, 1, "", "n_params"]], "torchnf.transformers.RQSplineTransform": [[2, 3, 1, "", "build_spline"], [2, 2, 1, "", "codomain"], [2, 2, 1, "", "domain"], [2, 3, 1, "", "handle_inputs_outside_interval"], [2, 5, 1, "", "identity_params"], [2, 5, 1, "", "n_params"]], "torchnf.transformers.Rescaling": [[2, 2, 1, "", "codomain"], [2, 2, 1, "", "domain"], [2, 5, 1, "", "identity_params"], [2, 5, 1, "", "n_params"]], "torchnf.transformers.Transformer": [[2, 2, 1, "", "codomain"], [2, 2, 1, "", "domain"], [2, 3, 1, "", "forward"], [2, 5, 1, "", "identity_params"], [2, 3, 1, "", "inverse"], [2, 5, 1, "", "n_params"]], "torchnf.transformers.Translation": [[2, 2, 1, "", "codomain"], [2, 2, 1, "", "domain"], [2, 5, 1, "", "identity_params"], [2, 5, 1, "", "n_params"], [2, 5, 1, "", "params_dim"]], "torchnf.utils": [[2, 6, 1, "", "expand_elements"], [2, 6, 1, "", "sum_except_batch"], [2, 6, 1, "", "timestamp"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:exception", "5": "py:property", "6": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "exception", "Python exception"], "5": ["py", "property", "Python property"], "6": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "torchnf": [0, 1, 2], "s": 0, "document": 0, "content": [0, 2], "indic": 0, "tabl": 0, "packag": 2, "submodul": 2, "condition": 2, "modul": 2, "core": 2, "except": 2, "lit_model": 2, "metric": 2, "model": 2, "network": 2, "prior": 2, "transform": 2, "util": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})