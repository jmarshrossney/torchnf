Search.setIndex({"docnames": ["index", "introduction", "torchnf", "torchnf.conditioners", "torchnf.distributions", "torchnf.exceptions", "torchnf.flow", "torchnf.lit_models", "torchnf.metrics", "torchnf.models", "torchnf.recipes", "torchnf.recipes.flows", "torchnf.recipes.layers", "torchnf.recipes.models", "torchnf.recipes.networks", "torchnf.transformers", "torchnf.utils"], "filenames": ["index.rst", "introduction.rst", "torchnf.rst", "torchnf.conditioners.rst", "torchnf.distributions.rst", "torchnf.exceptions.rst", "torchnf.flow.rst", "torchnf.lit_models.rst", "torchnf.metrics.rst", "torchnf.models.rst", "torchnf.recipes.rst", "torchnf.recipes.flows.rst", "torchnf.recipes.layers.rst", "torchnf.recipes.models.rst", "torchnf.recipes.networks.rst", "torchnf.transformers.rst", "torchnf.utils.rst"], "titles": ["Welcome to torchnf\u2019s documentation!", "Introduction", "torchnf", "torchnf.conditioners", "torchnf.distributions", "torchnf.exceptions", "torchnf.flow", "torchnf.lit_models", "torchnf.metrics", "torchnf.models", "torchnf.recipes", "torchnf.recipes.flows", "torchnf.recipes.layers", "torchnf.recipes.models", "torchnf.recipes.networks", "torchnf.transformers", "torchnf.utils"], "terms": {"introduct": 0, "condition": [0, 2, 6, 12, 14], "distribut": [0, 2, 3, 8, 9, 16], "except": [0, 2, 14], "flow": [0, 2, 3, 7, 8, 9, 10, 13, 14], "lit_model": [0, 2, 9], "metric": [0, 2, 7, 9], "model": [0, 2, 3, 7, 8, 10, 16], "transform": [0, 2, 3, 6, 12], "util": [0, 2, 9], "recip": [0, 2], "index": 0, "modul": [0, 3, 6, 7, 9, 14, 15], "search": 0, "page": 0, "good": 1, "morn": 1, "layer": [2, 3, 6, 10, 14, 15], "network": [2, 10, 11, 12], "The": [3, 4, 6, 8, 9, 15, 16], "forward": [3, 6, 7, 9, 14, 15], "method": [3, 4, 6, 8, 9, 14, 15], "should": [3, 9, 15, 16], "return": [3, 4, 6, 8, 9, 14, 15, 16], "set": [3, 9, 16], "paramet": [3, 4, 6, 8, 9, 14, 15, 16], "upon": [3, 15], "which": [3, 4, 6, 8, 9, 14, 15, 16], "condit": [3, 6, 9, 15], "class": [3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15], "autoregressivecondition": 3, "base": [3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15], "todo": [3, 14], "result": [3, 4, 9, 15, 16], "triangular": 3, "determin": [3, 6, 15], "train": [3, 6, 9, 13], "bool": [3, 6, 8, 9, 13, 14], "alia": [3, 15], "torch": [3, 4, 6, 7, 9, 11, 12, 14, 15, 16], "nn": [3, 6, 7, 14], "inherit": [3, 15], "all": [3, 4, 6, 15, 16], "input": [3, 4, 6, 15, 16], "tensor": [3, 4, 6, 7, 8, 9, 13, 15, 16], "context": [3, 6, 15, 16], "dict": [3, 6, 9, 14, 15], "option": [3, 8, 9, 13], "maskedcondition": [3, 12], "net": [3, 11, 12], "sequenti": [3, 6, 14, 16], "none": [3, 6, 8, 9, 13, 15], "mask": [3, 11, 12], "booltensor": [3, 11, 12, 15], "create_channel_dim": 3, "fals": [3, 8, 9, 14], "In": [3, 8, 15], "thi": [3, 4, 6, 7, 8, 9, 14, 15, 16], "x": [3, 6, 9, 15, 16], "ar": [3, 4, 8, 9, 15], "first": [3, 16], "so": [3, 8], "onli": 3, "subset": 3, "can": [3, 8, 9, 16], "influenc": 3, "furthermor": 3, "lambda": [3, 15], "us": [3, 4, 7, 8, 9, 14, 15, 16], "logic": 3, "negat": 3, "origin": [3, 4], "when": [3, 4], "point": 3, "wise": 3, "jacobian": [3, 6, 15], "A": [3, 4, 8, 9, 15, 16], "normal": [3, 4, 6, 8, 9], "where": [3, 8, 9, 15], "call": [3, 4, 9, 15], "coupl": 3, "archetyp": 3, "exampl": [3, 4], "real": [3, 12], "nvp": 3, "arxiv": [3, 8, 9], "1605": 3, "08803": 3, "deriv": [3, 8, 15], "mai": 3, "overrid": [3, 8, 15], "_forward": [3, 15], "get_mask": 3, "explain": 3, "how": 3, "get": [3, 9], "depend": 3, "data": [3, 8, 9, 15], "shape": [3, 4, 15, 16], "consid": 3, "allow": [3, 4, 9, 14], "function": [3, 8, 9, 15], "valu": [3, 8, 9], "aren": 3, "t": [3, 8, 15, 16], "zero": 3, "e": [3, 8, 14, 15], "g": [3, 8, 14], "nois": 3, "drawn": [3, 9], "from": [3, 6, 7, 8, 9, 16], "known": 3, "apply_mask_to_input": 3, "appli": [3, 8], "apply_mask_to_output": 3, "param": [3, 6, 15], "output": [3, 7, 8, 9, 15], "after": [3, 9], "element": [3, 8, 9, 15, 16], "nan": 3, "s": [3, 4, 6, 9, 15, 16], "doe": [3, 6, 9, 15, 16], "follow": [3, 6, 9, 15, 16], "self": [3, 4, 6, 9, 15], "x_mask": 3, "properti": [3, 9, 12, 15], "delin": 3, "partit": 3, "maskedconditionerstructurepreserv": 3, "simplecondition": 3, "init_param": 3, "union": [3, 9, 13], "list": [3, 9, 14, 15, 16], "float": [3, 9, 12, 15, 16], "independ": [3, 4, 14], "regist": 3, "make": [3, 4], "them": 3, "learnabl": 3, "simpli": [3, 6, 8, 9, 14], "initi": [3, 9], "expand": [3, 16], "correct": 3, "iterableprior": 4, "batch_shap": 4, "iter": 4, "int": [4, 9, 11, 12, 13, 14, 15, 16], "iterabledataset": 4, "wrap": 4, "around": [4, 15], "sampl": [4, 7, 8, 9, 16], "whose": [4, 6], "each": [4, 8, 9, 14, 16], "step": [4, 8, 9, 16], "batch": [4, 7, 9], "creat": [4, 14], "prior": [4, 7, 9], "expand_independ": 4, "uv_gauss": 4, "0": [4, 8, 15, 16], "1": [4, 8, 9, 15, 16], "6": 4, "size": [4, 8, 9, 15, 16], "an": [4, 6, 8, 9, 14, 15, 16], "100": 4, "iprior": 4, "next": 4, "ha": 4, "same": [4, 14, 15], "attribut": 4, "mean": [4, 8, 9], "log_prob": [4, 9], "sample_shap": 4, "abc": 4, "abstract": 4, "must": [4, 9], "implement": [4, 6, 7, 9, 13, 14], "def": 4, "target": [4, 7, 8, 9, 16], "expand_dist": 4, "event_shap": 4, "construct": [4, 6, 16], "multivari": 4, "iid": 4, "compon": 4, "ident": [4, 14, 15], "accord": 4, "event": [4, 15], "concaten": [4, 8, 9], "given": [4, 6, 8, 16], "includ": 4, "distibut": 4, "gaussian": 4, "diagon": 4, "covari": 4, "univari": 4, "mv_gauss": 4, "what": [4, 9], "happen": 4, "we": 4, "comput": [4, 8, 9], "log": [4, 6, 8, 9, 15, 16], "prob": 4, "flowlay": 6, "repres": [6, 8, 9, 14], "subclass": 6, "compos": 6, "sever": 6, "aggreg": 6, "tupl": [6, 7, 9, 12, 15], "pass": [6, 9, 15], "invers": [6, 9, 15], "y": [6, 8, 9, 15, 16], "step_forward": 6, "wip": 6, "specif": [6, 9, 14], "modular": 6, "structur": 6, "provid": [6, 9], "flexibl": 6, "varieti": 6, "differ": 6, "instanc": [6, 14], "take": [6, 9, 15], "conditioner_forward": 6, "xy": 6, "unless": [6, 9, 15], "overriden": 6, "overridden": [6, 9, 15], "ldj": 6, "transformer_forward": 6, "freez": 6, "detach": 6, "autograd": 6, "graph": 6, "transformer_invers": 6, "transfom": 6, "unfreez": 6, "reattach": 6, "altern": 7, "pytorch_lightn": [7, 9], "lightningmodul": [7, 9], "rather": 7, "than": [7, 15], "standard": [7, 9], "work": [7, 14], "progress": [7, 9, 14, 16], "do": [7, 15], "litboltzmanngener": 7, "callabl": 7, "object": [7, 11, 12, 14, 15], "test": [7, 8, 9, 16], "configure_optim": 7, "train_dataload": 7, "training_step": [7, 9], "batch_idx": 7, "training_step_end": 7, "val_dataload": 7, "validation_epoch_end": 7, "validation_step": [7, 9], "acceptancer": 8, "logstatweightmetricmcmc": 8, "fraction": 8, "propos": [8, 9, 16], "accept": [8, 9], "dure": [8, 9], "metropoli": [8, 9, 16], "hast": [8, 9, 16], "probabl": [8, 16], "densiti": [8, 9], "p": [8, 9, 16], "gener": [8, 9, 14, 16], "sim": 8, "q": [8, 9, 16], "prime": [8, 9, 16], "min": [8, 9, 16], "left": [8, 9, 15, 16], "frac": [8, 9, 15, 16], "right": [8, 9, 15, 16], "speak": 8, "rate": [8, 9], "larger": 8, "overlap": 8, "between": [8, 9], "final": [8, 9], "state": [8, 9, 16], "variabl": 8, "synchron": 8, "across": 8, "backend": 8, "higher_is_bett": 8, "true": [8, 9, 15], "effectivesamples": 8, "logstatweightmetr": 8, "effect": [8, 16], "normalis": [8, 15], "defin": [8, 9, 14, 16], "n_": 8, "eff": 8, "n": [8, 16], "sum_": 8, "w": [8, 16], "2": [8, 9, 15], "quantiti": 8, "actual": 8, "refer": [8, 9, 15], "2101": 8, "08176": 8, "integratedautocorrel": 8, "integr": 8, "autocorrel": 8, "reject": [8, 9], "histori": 8, "limit": 8, "infti": 8, "re": 8, "interpret": 8, "fail": 8, "transit": [8, 16], "over": [8, 15, 16], "number": [8, 9, 15], "markov": [8, 9, 16], "chain": [8, 9, 16], "gamma": 8, "pr": 8, "text": 8, "consecut": 8, "estim": 8, "obtain": 8, "sum": [8, 16], "occurr": 8, "largest": 8, "possibl": 8, "total": [8, 9], "1904": 8, "12072": 8, "requir": 8, "statist": [8, 9], "weight": [8, 9, 16], "logarithm": [8, 9, 15], "respect": [8, 9, 15], "reduc": 8, "If": [8, 9], "singl": [8, 9], "calcul": [8, 9], "otherwis": 8, "updat": [8, 9], "its": 8, "own": 8, "full_state_upd": 8, "is_differenti": 8, "log_weight": [8, 9, 16], "logstatweightmetriccollect": 8, "mcmc": [8, 9], "metriccollect": [8, 9], "collect": 8, "though": 8, "thei": [8, 15], "correspond": [8, 15, 16], "sequenc": 8, "simul": 8, "addit": 8, "aris": 8, "longestrejectionrun": 8, "phase": [8, 9], "note": [8, 9, 16], "floattensor": 8, "without": 8, "cast": 8, "shiftedkldiverg": 8, "shift": 8, "kullbach": 8, "leibler": 8, "diverg": 8, "tild": 8, "d": 8, "_": [8, 9], "kl": [8, 9], "contain": [9, 14, 15, 16], "some": [9, 14, 16], "see": [9, 14], "equival": 9, "version": [9, 14], "boltzmanngener": [9, 13], "output_dir": [9, 13], "str": [9, 12, 13, 14, 16], "pathlik": [9, 13], "boltzmann": 9, "term": 9, "wa": 9, "introduc": [9, 15], "1812": 9, "01729": 9, "batch_siz": [9, 13, 15], "evalu": [9, 16], "log_prob_prior": 9, "log_det_jacob": [9, 15], "log_prob_target": 9, "through": [9, 16], "under": 9, "rais": 9, "notimplementederror": 9, "mcmc_current_st": 9, "current": [9, 16], "mcmc_sampl": 9, "initialis": [9, 16], "usual": 9, "need": 9, "user": [9, 14, 16], "explicitli": 9, "automat": 9, "end": 9, "unbias": [9, 16], "algorithm": [9, 16], "asymptot": [9, 16], "oherwis": 9, "metropolis_test": [9, 16], "perform": [9, 15], "loss": 9, "training_step_fwd_kl": 9, "training_step_rev_kl": 9, "revers": 9, "train_batch_s": 9, "neg": 9, "valid": 9, "weighted_sampl": 9, "multipl": [9, 14], "time": 9, "gradient": 9, "disabl": 9, "bias": 9, "howev": 9, "expect": 9, "essenti": 9, "act": 9, "save": 9, "load": 9, "etc": 9, "It": 9, "assign": 9, "directori": 9, "checkpoint": 9, "dedic": 9, "fallback": 9, "generate_output_dir": 9, "optim": 9, "support": 9, "configure_train": 9, "optimizer_kwarg": 9, "schedul": 9, "scheduler_kwarg": 9, "ckpt_interv": 9, "pbar_interv": 9, "25": 9, "up": 9, "execut": 9, "befor": 9, "run": [9, 15, 16], "fit": 9, "string": [9, 16], "denot": 9, "keyword": 9, "argument": [9, 15], "learn": 9, "lr_schedul": 9, "falsei": 9, "never": 9, "bar": [9, 16], "configure_valid": 9, "interv": [9, 12, 15], "occur": 9, "current_loss": 9, "most": 9, "recent": 9, "loop": 9, "rang": 9, "optimizer_step": 9, "along": [9, 15, 16], "increment": 9, "global_step": 9, "global": 9, "within": 9, "uniqu": 9, "path": 9, "sinc": 9, "load_checkpoint": 9, "pt": 9, "file": 9, "save_checkpoint": 9, "log_train": 9, "inform": 9, "log_valid": 9, "By": 9, "default": 9, "item": 9, "val_metr": 9, "histogram": 9, "also": 9, "logger": 9, "summarywrit": 9, "handl": [9, 15], "tensorboard": 9, "switch": [9, 16], "no_log": 9, "optimization_step": 9, "zero_grad": 9, "backward": 9, "name": 9, "ckpt_": 9, "snapshot": 9, "well": 9, "torchmetr": 9, "overidden": 9, "just": 9, "val_batchess": 9, "nice": 11, "netbuild": [11, 12, 14], "n_block": 11, "realnvp": 11, "n_layer": 11, "additivecouplinglay": 12, "couplinglay": 12, "translat": [12, 15], "affinecouplinglay": 12, "affinetransform": [12, 15], "multiplicativecouplinglay": 12, "rescal": [12, 15], "rqsplinecouplinglay": 12, "n_segment": [12, 15], "domain": [12, 15], "rqsplinetransform": [12, 15], "multivariategaussiansampl": 13, "loc": 13, "covariance_matrix": 13, "precision_matrix": 13, "vonmisessampl": 13, "Not": 13, "yet": 13, "conveni": 14, "neural": 14, "herein": 14, "__call__": [14, 15], "one": [14, 15, 16], "easili": 14, "spec": 14, "document": 14, "wai": 14, "new": [14, 16], "specifi": 14, "chang": [14, 15, 16], "dataclass": 14, "replac": 14, "convnet": 14, "dim": [14, 16], "in_channel": 14, "out_channel": 14, "hidden_shap": 14, "activ": 14, "kernel_s": 14, "activation_kwarg": 14, "factori": 14, "skip_final_activ": 14, "conv_kwarg": 14, "convolut": 14, "conv2d": 14, "1d": 14, "3d": 14, "convnetcircular": 14, "circular": 14, "pad": 14, "densenet": 14, "in_featur": 14, "out_featur": 14, "linear_kwarg": 14, "fulli": 14, "connect": 14, "feed": 14, "linear": 14, "genericnetbuild": 14, "purpos": 14, "builder": 14, "parametris": 15, "biject": 15, "more": 15, "math": 15, "longrightarrow": 15, "f": 15, "lvert": 15, "partial": 15, "rvert": 15, "thank": 15, "theorem": 15, "relat": 15, "pointwis": 15, "affin": 15, "mapsto": 15, "odot": 15, "sum_i": 15, "s_i": 15, "i": 15, "degre": 15, "freedom": 15, "being": 15, "stack": [15, 16], "order": 15, "dimens": [15, 16], "split": [15, 16], "parma": 15, "data_shap": [15, 16], "n_param": 15, "_invers": 15, "codomain": 15, "classvar": 15, "inf": 15, "identity_param": 15, "per": 15, "ration": 15, "quadrat": 15, "spline": 15, "build_splin": 15, "width": 15, "height": 15, "build": 15, "gregori": 15, "delbourgo": 15, "1983": 15, "un": 15, "segment": 15, "unconstrain": 15, "knot": 15, "3": 15, "constrain": 15, "4": 15, "coordin": 15, "5": 15, "j": 15, "r": 15, "c2": 15, "interpol": 15, "monoton": 15, "ima": 15, "journal": 15, "numer": 15, "analysi": 15, "141": 15, "152": 15, "handle_inputs_outside_interv": 15, "outside_interval_mask": 15, "fall": 15, "outsid": 15, "submit": 15, "debug": 15, "1000": 15, "fell": 15, "rqsplinetransformcirculardomain": 15, "rqsplinetransformintervaldomain": 15, "wrapper": 15, "_nan_to_ident": 15, "There": 15, "volum": 15, "eval_mod": 16, "temporarili": 16, "mode": 16, "snippet": 16, "adapt": 16, "christoph_heindl": 16, "post": 16, "discuss": 16, "pytorch": 16, "org": 16, "opinion": 16, "eval": 16, "manag": 16, "18998": 16, "mit": 16, "licens": 16, "expand_el": 16, "stack_dim": 16, "dimension": 16, "chunk": 16, "zeroth": 16, "One": 16, "el": 16, "out": 16, "subject": 16, "exactli": 16, "For": 16, "member": 16, "indic": 16, "pbar_descript": 16, "pbar": 16, "tqdm": 16, "desc": 16, "descript": 16, "prod": 16, "product": 16, "sum_except_batch": 16, "timestamp": 16, "fmt": 16, "m": 16, "dt": 16, "h": 16, "represent": 16, "datetim": 16}, "objects": {"torchnf": [[3, 0, 0, "-", "conditioners"], [4, 0, 0, "-", "distributions"], [5, 0, 0, "-", "exceptions"], [6, 0, 0, "-", "flow"], [7, 0, 0, "-", "lit_models"], [8, 0, 0, "-", "metrics"], [9, 0, 0, "-", "models"], [15, 0, 0, "-", "transformers"], [16, 0, 0, "-", "utils"]], "torchnf.conditioners": [[3, 1, 1, "", "AutoregressiveConditioner"], [3, 1, 1, "", "Conditioner"], [3, 1, 1, "", "MaskedConditioner"], [3, 1, 1, "", "MaskedConditionerStructurePreserving"], [3, 1, 1, "", "SimpleConditioner"]], "torchnf.conditioners.AutoregressiveConditioner": [[3, 2, 1, "", "training"]], "torchnf.conditioners.Conditioner": [[3, 3, 1, "", "forward"], [3, 2, 1, "", "training"]], "torchnf.conditioners.MaskedConditioner": [[3, 3, 1, "", "apply_mask_to_input"], [3, 3, 1, "", "apply_mask_to_output"], [3, 3, 1, "", "forward"], [3, 4, 1, "", "mask"], [3, 2, 1, "", "training"]], "torchnf.conditioners.MaskedConditionerStructurePreserving": [[3, 3, 1, "", "apply_mask_to_input"], [3, 3, 1, "", "apply_mask_to_output"], [3, 2, 1, "", "training"]], "torchnf.conditioners.SimpleConditioner": [[3, 3, 1, "", "forward"], [3, 2, 1, "", "training"]], "torchnf.distributions": [[4, 1, 1, "", "IterablePrior"], [4, 1, 1, "", "Prior"], [4, 1, 1, "", "Target"], [4, 5, 1, "", "expand_dist"]], "torchnf.distributions.IterablePrior": [[4, 3, 1, "", "log_prob"], [4, 3, 1, "", "sample"]], "torchnf.distributions.Prior": [[4, 3, 1, "", "log_prob"], [4, 3, 1, "", "sample"]], "torchnf.distributions.Target": [[4, 3, 1, "", "log_prob"]], "torchnf.flow": [[6, 1, 1, "", "Flow"], [6, 1, 1, "", "FlowLayer"]], "torchnf.flow.Flow": [[6, 3, 1, "", "forward"], [6, 3, 1, "", "inverse"], [6, 3, 1, "", "step_forward"]], "torchnf.flow.FlowLayer": [[6, 3, 1, "", "conditioner_forward"], [6, 3, 1, "", "forward"], [6, 3, 1, "", "freeze"], [6, 3, 1, "", "inverse"], [6, 2, 1, "", "training"], [6, 3, 1, "", "transformer_forward"], [6, 3, 1, "", "transformer_inverse"], [6, 3, 1, "", "unfreeze"]], "torchnf.lit_models": [[7, 1, 1, "", "LitBoltzmannGenerator"]], "torchnf.lit_models.LitBoltzmannGenerator": [[7, 3, 1, "", "configure_optimizers"], [7, 3, 1, "", "forward"], [7, 3, 1, "", "sample"], [7, 3, 1, "", "train_dataloader"], [7, 3, 1, "", "training_step"], [7, 3, 1, "", "training_step_end"], [7, 3, 1, "", "val_dataloader"], [7, 3, 1, "", "validation_epoch_end"], [7, 3, 1, "", "validation_step"]], "torchnf.metrics": [[8, 1, 1, "", "AcceptanceRate"], [8, 1, 1, "", "EffectiveSampleSize"], [8, 1, 1, "", "IntegratedAutocorrelation"], [8, 1, 1, "", "LogStatWeightMetric"], [8, 1, 1, "", "LogStatWeightMetricCollection"], [8, 1, 1, "", "LogStatWeightMetricMCMC"], [8, 1, 1, "", "LongestRejectionRun"], [8, 1, 1, "", "ShiftedKLDivergence"]], "torchnf.metrics.AcceptanceRate": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "higher_is_better"]], "torchnf.metrics.EffectiveSampleSize": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "higher_is_better"]], "torchnf.metrics.IntegratedAutocorrelation": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "higher_is_better"]], "torchnf.metrics.LogStatWeightMetric": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "full_state_update"], [8, 2, 1, "", "is_differentiable"], [8, 3, 1, "", "update"]], "torchnf.metrics.LogStatWeightMetricMCMC": [[8, 2, 1, "", "is_differentiable"], [8, 3, 1, "", "update"]], "torchnf.metrics.LongestRejectionRun": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "higher_is_better"]], "torchnf.metrics.ShiftedKLDivergence": [[8, 3, 1, "", "compute"], [8, 2, 1, "", "higher_is_better"]], "torchnf.models": [[9, 1, 1, "", "BoltzmannGenerator"], [9, 1, 1, "", "Model"]], "torchnf.models.BoltzmannGenerator": [[9, 3, 1, "", "forward"], [9, 3, 1, "", "inverse"], [9, 4, 1, "", "mcmc_current_state"], [9, 3, 1, "", "mcmc_sample"], [9, 2, 1, "", "training"], [9, 3, 1, "", "training_step"], [9, 3, 1, "", "training_step_fwd_kl"], [9, 3, 1, "", "training_step_rev_kl"], [9, 3, 1, "", "validation_step"], [9, 3, 1, "", "weighted_sample"]], "torchnf.models.Model": [[9, 3, 1, "", "configure_training"], [9, 3, 1, "", "configure_validation"], [9, 4, 1, "", "current_loss"], [9, 3, 1, "", "fit"], [9, 3, 1, "", "generate_output_dir"], [9, 4, 1, "", "global_step"], [9, 3, 1, "", "load_checkpoint"], [9, 3, 1, "", "log_training"], [9, 3, 1, "", "log_validation"], [9, 4, 1, "", "logger"], [9, 3, 1, "", "logging"], [9, 3, 1, "", "no_logging"], [9, 3, 1, "", "optimization_step"], [9, 4, 1, "", "output_dir"], [9, 3, 1, "", "save_checkpoint"], [9, 2, 1, "", "training"], [9, 3, 1, "", "training_step"], [9, 3, 1, "", "validate"], [9, 3, 1, "", "validation_step"]], "torchnf.recipes": [[11, 0, 0, "-", "flows"], [12, 0, 0, "-", "layers"], [13, 0, 0, "-", "models"], [14, 0, 0, "-", "networks"]], "torchnf.recipes.flows": [[11, 1, 1, "", "NICE"], [11, 1, 1, "", "RealNVP"]], "torchnf.recipes.flows.NICE": [[11, 2, 1, "", "mask"], [11, 2, 1, "", "n_blocks"], [11, 2, 1, "", "net"]], "torchnf.recipes.flows.RealNVP": [[11, 2, 1, "", "n_layers"]], "torchnf.recipes.layers": [[12, 1, 1, "", "AdditiveCouplingLayer"], [12, 1, 1, "", "AffineCouplingLayer"], [12, 1, 1, "", "CouplingLayer"], [12, 1, 1, "", "MultiplicativeCouplingLayer"], [12, 1, 1, "", "RQSplineCouplingLayer"]], "torchnf.recipes.layers.AdditiveCouplingLayer": [[12, 2, 1, "", "mask"], [12, 2, 1, "", "net"], [12, 4, 1, "", "transformer"]], "torchnf.recipes.layers.AffineCouplingLayer": [[12, 2, 1, "", "mask"], [12, 2, 1, "", "net"], [12, 4, 1, "", "transformer"]], "torchnf.recipes.layers.CouplingLayer": [[12, 4, 1, "", "conditioner"], [12, 2, 1, "", "mask"], [12, 2, 1, "", "net"], [12, 4, 1, "", "transformer"]], "torchnf.recipes.layers.MultiplicativeCouplingLayer": [[12, 2, 1, "", "mask"], [12, 2, 1, "", "net"], [12, 4, 1, "", "transformer"]], "torchnf.recipes.layers.RQSplineCouplingLayer": [[12, 2, 1, "", "domain"], [12, 2, 1, "", "interval"], [12, 2, 1, "", "n_segments"], [12, 4, 1, "", "transformer"]], "torchnf.recipes.models": [[13, 1, 1, "", "MultivariateGaussianSampler"], [13, 1, 1, "", "VonMisesSampler"]], "torchnf.recipes.models.MultivariateGaussianSampler": [[13, 2, 1, "", "training"]], "torchnf.recipes.models.VonMisesSampler": [[13, 2, 1, "", "training"]], "torchnf.recipes.networks": [[14, 1, 1, "", "ConvNet"], [14, 1, 1, "", "ConvNetCircular"], [14, 1, 1, "", "DenseNet"], [14, 1, 1, "", "GenericNetBuilder"], [14, 1, 1, "", "NetBuilder"]], "torchnf.recipes.networks.ConvNet": [[14, 2, 1, "", "activation"], [14, 2, 1, "", "activation_kwargs"], [14, 2, 1, "", "conv_kwargs"], [14, 2, 1, "", "dim"], [14, 2, 1, "", "hidden_shape"], [14, 2, 1, "", "in_channels"], [14, 2, 1, "", "kernel_size"], [14, 2, 1, "", "out_channels"], [14, 2, 1, "", "skip_final_activation"]], "torchnf.recipes.networks.ConvNetCircular": [[14, 2, 1, "", "activation"], [14, 2, 1, "", "activation_kwargs"], [14, 2, 1, "", "conv_kwargs"], [14, 2, 1, "", "dim"], [14, 2, 1, "", "hidden_shape"], [14, 2, 1, "", "in_channels"], [14, 2, 1, "", "kernel_size"], [14, 2, 1, "", "out_channels"]], "torchnf.recipes.networks.DenseNet": [[14, 2, 1, "", "activation"], [14, 2, 1, "", "activation_kwargs"], [14, 2, 1, "", "hidden_shape"], [14, 2, 1, "", "in_features"], [14, 2, 1, "", "linear_kwargs"], [14, 2, 1, "", "out_features"], [14, 2, 1, "", "skip_final_activation"]], "torchnf.transformers": [[15, 1, 1, "", "AffineTransform"], [15, 1, 1, "", "RQSplineTransform"], [15, 1, 1, "", "RQSplineTransformCircularDomain"], [15, 1, 1, "", "RQSplineTransformIntervalDomain"], [15, 1, 1, "", "Rescaling"], [15, 1, 1, "", "Transformer"], [15, 1, 1, "", "Translation"]], "torchnf.transformers.AffineTransform": [[15, 3, 1, "", "_forward"], [15, 3, 1, "", "_inverse"], [15, 2, 1, "", "codomain"], [15, 2, 1, "", "domain"], [15, 4, 1, "", "identity_params"], [15, 4, 1, "", "n_params"]], "torchnf.transformers.RQSplineTransform": [[15, 3, 1, "", "_forward"], [15, 3, 1, "", "_inverse"], [15, 3, 1, "", "build_spline"], [15, 2, 1, "", "codomain"], [15, 2, 1, "", "domain"], [15, 3, 1, "", "handle_inputs_outside_interval"], [15, 4, 1, "", "identity_params"], [15, 4, 1, "", "n_params"]], "torchnf.transformers.Rescaling": [[15, 3, 1, "", "_forward"], [15, 3, 1, "", "_inverse"], [15, 2, 1, "", "codomain"], [15, 2, 1, "", "domain"], [15, 4, 1, "", "identity_params"], [15, 4, 1, "", "n_params"]], "torchnf.transformers.Transformer": [[15, 3, 1, "", "__call__"], [15, 3, 1, "", "_forward"], [15, 3, 1, "", "_inverse"], [15, 2, 1, "", "codomain"], [15, 2, 1, "", "domain"], [15, 3, 1, "", "forward"], [15, 4, 1, "", "identity_params"], [15, 3, 1, "", "inverse"], [15, 4, 1, "", "n_params"]], "torchnf.transformers.Translation": [[15, 3, 1, "", "_forward"], [15, 2, 1, "", "codomain"], [15, 2, 1, "", "domain"], [15, 4, 1, "", "identity_params"], [15, 4, 1, "", "n_params"]], "torchnf.utils": [[16, 5, 1, "", "eval_mode"], [16, 5, 1, "", "expand_elements"], [16, 5, 1, "", "metropolis_test"], [16, 5, 1, "", "pbar_description"], [16, 5, 1, "", "prod"], [16, 5, 1, "", "sum_except_batch"], [16, 5, 1, "", "timestamp"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "torchnf": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "s": 0, "document": 0, "content": 0, "indic": 0, "tabl": 0, "introduct": 1, "condition": 3, "distribut": 4, "except": 5, "flow": [6, 11], "lit_model": 7, "metric": 8, "model": [9, 13], "recip": [10, 11, 12, 13, 14], "layer": 12, "network": 14, "transform": 15, "util": 16}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})